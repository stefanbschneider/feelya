{% extends 'app/base.html' %}

{# based on https://www.geeksforgeeks.org/data-visualization-using-chartjs-and-django/ #}
{% block content %}
    <div id="container">
        <canvas id="myChart" data-url="{% url 'app:eval_data' %}"></canvas>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    <script>
        var endpoint = '{% url 'app:eval_data' %}';

        $.ajax({
            url: endpoint,
            success: function (data) {
                plotEntries(data, 'myChart');
            },
            error: function (error_data) {
                console.log(error_data);
            }
        })

        function plotEntries(data, id) {
            var labels = data.labels;
            var chartLabel = data.chartLabel;
            var chartData = data.chartData;
            var ctx = document.getElementById(id).getContext('2d');
            var chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: chartLabel,
                        data: chartData,
                        borderWidth: 1,
                    }]
                },
                options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
            })
        }

        {#var ctx = document.getElementById('myChart').getContext('2d')#}
        {#var myBarChart = new Chart(ctx, {#}
        {#    type: 'bar',#}
        {#    data: {#}
        {#        labels: ['MÃ¼sli', 'Running', 'Coding'],#}
        {#        datasets: [{#}
        {#            label: '# of Entries',#}
        {#            data: [12, 4, 8],#}
        {#            borderWidth: 1,#}
        {#        }]#}
        {#    },#}
        {#    options: {#}
        {#        scales: {#}
        {#            yAxes: [{#}
        {#                ticks: {#}
        {#                    beginAtZero: true#}
        {#                }#}
        {#            }]#}
        {#        }#}
        {#    }#}
        {#});#}
    </script>



    {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

    <ul>
    {% for name, count in entry_counts.items %}
        <li>{{ count }}x: {{ name }}</li>
    {% endfor %}
    </ul>
{% endblock %}